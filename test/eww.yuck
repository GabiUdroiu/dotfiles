;; Popup-ul cu setări
(
  defwindow test[]
  :monitor 0
  :geometry (geometry :width "200px" :height "30" :anchor "top right")
  :visible false
  (topbar)
)

(
  defwidget topbar []
  (
    box :class "test" :orientation "v" :hexpand false :vexpand false :spacing 15
    (
      box :class "inside" :orientation "h" :spacing 0
      (box :class "char" :halign "start" "")
      (
        box :class "info" :halign "start" :orientation "v"
        (box "${"gabi"}${"bos"}")
        (button :class "oxo" :halign "start" " 1h, 20m")
      )
      (
        box :halign "end" :space-evenly true :spacing 10
        (button :class "shutdown" :cursor "pointer" :onclick "$(systemctl poweroff)" "⏻ ")
        (button :class "reboot"  :onclick "$(systemctl reboot)" "")
        (button :class "lock"  :onclick "" "")
      )
    )
    ; (
      ;   box :orientation "h" :vexpand false :hexpand false
      ;   (button :halign "start" " 1h, 20m")
      ;   (button :halign "end" "")
      
    ; )
    (audio :volume test)
  )
)

(
  defwidget osd []
  (box :orientation "h" :valign "center" :class "close"
    (button :class "close" :vexpand false :hexpand false :halign "center" :onclick "/home/gabi/.config/eww/bar/scripts/test.sh" "close")
  )
)


(
  defwidget powermenu []
  (
    box :orientation "h" :valign "center" :space-evenly true :spacing 20
    (button :class "shutdown" :onclick "$(systemctl poweroff)" "⏻ ")
    (button :class "reboot" :onclick "$(systemctl reboot)" "")
    (button :class "lock" :onclick "" " ")
  )
)

;(defpoll test :interval "1s" `echo $(wpctl get-volume @DEFAULT_AUDIO_SINK@ | awk '{print int($2*100)}')`)

(defwidget audio [volume]
  (box :class "audio-box" :vexpand "false" :hexpand "false" :spacing 5
    (box :class "xd" :orientation "v" :spacing 25 :halign "center" :valign "center" :space-evenly "false" :vexpand "false" :hexpand "false"
      (box :class "volume_bar" :orientation "h" :spacing 20 :space-evenly "false" :vexpand "false" :hexpand "false"
        (button :class "vol_icon" "󰕾")
        (scale :flipped "false" :orientation "h" :min 0 :max 101 :value {volume} :onchange "wpctl set-volume @DEFAULT_AUDIO_SINK@ {}%")
        (label :text "${test}%" :class "vol_number")
      )
      (box :class "volume_bar" :orientation "h" :spacing 20 :space-evenly "false" :vexpand "false" :hexpand "false"
        (button :class "vol_icon" "󰃟")
        (scale :flipped "false" :orientation "h" :min 0 :max 101 :value {volume} :onchange "wpctl set-volume @DEFAULT_AUDIO_SINK@ {}%")
        (label :text "${test}%" :class "vol_number")
      )
    ))
)
